function a124_0x1a2f(){const _0x3f97aa=['logBuildError','false','config','framework','wlDcd','api/v1/builds/','true','BROWSERSTACK_LINKED_BUILD_UUID','../../bin/playwright/reporter/test-details.js','getHostInfo','auth','TESTHUB_BUILD_API','measureWrapper','getTestOrchestrationBuildStartData','../test-observability/sessionHandler.js','UVAOQ','format','POST','isAccessibilityEnabled','buildStopSent','1797uNyPzI','cUgRs','getAccessibilityValueFromYml','isBrowserstackInfra','password','7188tRJcbf','buildName','BS_TESTOPS_BUILD_COMPLETED','data','ZXfnp','Generating\x20build\x20upstream\x20data\x20for\x20TestHub','BROWSERSTACK_CENTRAL_SCANNER_JWT','extractDataFromResponse','getUserName','BROWSERSTACK_TEST_OBSERVABILITY','BROWSERSTACK_TESTHUB_UUID','19CTGxjm','buildIdentifier','central_scanner','message','eFopp','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20','../logger','Exception\x20while\x20creating\x20test\x20run\x20for\x20BrowserStack\x20Accessibility\x20Automation:\x20Missing\x20authentication\x20token','13074418ZhrQry','xqjTv','jpKpz','../test-observability/requestQueueHandler.js','./constants.js','launchBuild','push','wGujj','Error\x20while\x20waiting\x20for\x20events:\x20','projectName','EXCEPTION\x20IN\x20BUILD\x20START\x20EVENT\x20:\x20Missing\x20authentication\x20token','sJuom','user_killed','username','util','Nfhqv','\x20framework','allowScreenshot','BROWSERSTACK_BUILD_GROUPING_IDENTIFIER','BROWSERSTACK_BUILD_RUN_IDENTIFIER','success','processTraceZips','stop','Percy\x20is\x20not\x20supported\x20for\x20','dIxFw','lzYyv','340620zSIOUy','info','BROWSERSTACK_TEST_ACCESSIBILITY_PLATFORM','VtUUM','job_id','/stop','getProductMapForBuildStartCall','getAccessibilityOptions','BROWSERSTACK_RERUN','exports','getTraceFilePaths','iTkZI','authToken','PUT','checkAndSetupPercy','allSettled','../test-observability/utils','BROWSERSTACK_CENTRAL_SCANNER_JOBID','./utils.js','add','qChWa','accessibilityOptions','hbgDn','START','response','jouKS','setupPercy','resolve','TSDuX','generateBuildUpstreamData','xGExc','null','toISOString','jwt','rkfQb','settings','../../bin/playwright/reporter/pwUtils.js','OBSERVABILITY','../performance/constants','npXiv','8CDObEn','XhhOv','path','30lJCJHM','STOP','ACCESSIBILITY','gHVwZ','getInstance','buildDescription','cwd','gJFGQ','setAccessibilityVariables','25954rYtBxu','getProductMap','buildHashedId','Testhub\x20started\x20with\x20id:\x20','All\x20trace\x20zip\x20send\x20events\x20complete','12615471BwOsQv','assign','status','OiOLk','ENV_VAR','FKpNg','9332916OPNXJu','ZpULD','accessibility','getConfig','pSfyN','percy','BROWSERSTACK_TESTHUB_JWT','EXCEPTION\x20IN\x20stopBuildUpstream\x20REQUEST\x20TO\x20TESTHUB\x20:\x20Missing\x20authentication\x20token','../performance/performance-tester.js','stringify','CzqUI','error','basename','setTestObservabilityVariables','iCKhR','debug','getCentralUser','env','BROWSERSTACK_ACCESSIBILITY','617769vHpdOp','DwRqe','VHbiu','token','lsLIo'];a124_0x1a2f=function(){return _0x3f97aa;};return a124_0x1a2f();}const a124_0x391b1a=a124_0x4dbb;(function(_0x8769fe,_0x18d83a){const _0x4524e3=a124_0x4dbb,_0x2b457f=_0x8769fe();while(!![]){try{const _0x581e62=-parseInt(_0x4524e3(0x126))/0x1*(parseInt(_0x4524e3(0xdf))/0x2)+-parseInt(_0x4524e3(0x116))/0x3*(-parseInt(_0x4524e3(0x11b))/0x4)+parseInt(_0x4524e3(0x148))/0x5+-parseInt(_0x4524e3(0xea))/0x6+-parseInt(_0x4524e3(0x12e))/0x7+-parseInt(_0x4524e3(0xd3))/0x8*(-parseInt(_0x4524e3(0xfd))/0x9)+parseInt(_0x4524e3(0xd6))/0xa*(parseInt(_0x4524e3(0xe4))/0xb);if(_0x581e62===_0x18d83a)break;else _0x2b457f['push'](_0x2b457f['shift']());}catch(_0x5e439b){_0x2b457f['push'](_0x2b457f['shift']());}}}(a124_0x1a2f,0xf0378));const bsSetupHelper=require('../helper'),path=require(a124_0x391b1a(0xd5)),util=require(a124_0x391b1a(0x13c)),{getCustomTags,isTestObservabilitySession,getDefaultHeaders,nodeRequest}=require(a124_0x391b1a(0xbb)),testhubUtils=require(a124_0x391b1a(0xbd)),testHubConstants=require(a124_0x391b1a(0x132)),constants=require('../../bin/utils/constants.js'),RequestQueueHandler=require(a124_0x391b1a(0x131)),logger=require(a124_0x391b1a(0x12c))['winstonLogger'],SessionHandler=require(a124_0x391b1a(0x110)),PerformanceTester=require(a124_0x391b1a(0xf2)),{TESTHUB_EVENTS:PerformanceEvents}=require(a124_0x391b1a(0xd1)),TestDetails=require(a124_0x391b1a(0x10a)),{uploadTraceZip}=require(a124_0x391b1a(0xcf)),{isTurboScaleSession}=require('../helper.js'),BrowserstackCLI=require('../../bin/v2/browserstackCLI'),OngoingEvents=new Set();let processedTraceZips=![];const addEvent=_0x16a3fa=>{const _0x43f085=a124_0x391b1a;OngoingEvents[_0x43f085(0xbe)](_0x16a3fa);},awaitAllEvents=async()=>{const _0x89d66a=a124_0x391b1a;return Promise[_0x89d66a(0xba)](OngoingEvents);};class TestHubHandler{static [a124_0x391b1a(0x115)]=![];static async[a124_0x391b1a(0x133)](_0x4cd55c,_0x49262e){const _0xa77a39=a124_0x391b1a,_0x28a518={'wGujj':function(_0x1ec8a5,_0x22628b){return _0x1ec8a5||_0x22628b;},'iTkZI':function(_0x42f708,_0x2dce12){return _0x42f708||_0x2dce12;},'dIxFw':function(_0x1e56b1,_0x384949){return _0x1e56b1===_0x384949;},'XhhOv':function(_0x1c1486){return _0x1c1486();},'ZXfnp':_0xa77a39(0x138),'jpKpz':_0xa77a39(0x103),'wlDcd':_0xa77a39(0x12d),'TSDuX':function(_0x2a721e,_0x29524f,_0x5d45f8,_0x884319,_0x53f496){return _0x2a721e(_0x29524f,_0x5d45f8,_0x884319,_0x53f496);},'npXiv':_0xa77a39(0x113),'BKSWo':_0xa77a39(0xec),'ZpULD':_0xa77a39(0x108)};await PerformanceTester[_0xa77a39(0x10e)](PerformanceEvents[_0xa77a39(0xc2)],async()=>{const _0x5048f1=_0xa77a39,_0x42abe8=Object[_0x5048f1(0xe5)]({},_0x49262e[_0x5048f1(0x104)],{'root_dir_path':'','framework':_0x49262e[_0x5048f1(0x105)]}),_0x46e773=bsSetupHelper[_0x5048f1(0x123)](_0x42abe8),_0x883250=bsSetupHelper['getAccessKey'](_0x42abe8),_0x429fd6=_0x28a518[_0x5048f1(0x135)](_0x46e773,'')+':'+_0x28a518[_0x5048f1(0x153)](_0x883250,''),_0x41aba4=testhubUtils[_0x5048f1(0xe0)](_0x42abe8);process[_0x5048f1(0xfb)]['BROWSERSTACK_PRODUCT_MAP']=JSON[_0x5048f1(0xf3)](_0x41aba4);if(_0x28a518['dIxFw'](_0x429fd6,':'))return _0x28a518[_0x5048f1(0xd4)](isTestObservabilitySession)&&(logger['debug'](_0x28a518[_0x5048f1(0x11f)]),process[_0x5048f1(0xfb)][_0x5048f1(0x11d)]=_0x28a518[_0x5048f1(0x130)]),testhubUtils[_0x5048f1(0x114)](_0x42abe8)&&logger[_0x5048f1(0xf9)](_0x28a518[_0x5048f1(0x106)]),[null,null];try{const _0x42dc5f=await this[_0x5048f1(0xc8)](_0x42abe8,_0x4cd55c),_0x4648cb=this[_0x5048f1(0xed)](_0x46e773,_0x883250),_0x1f1e2e=await _0x28a518[_0x5048f1(0xc7)](nodeRequest,_0x28a518[_0x5048f1(0xd2)],testHubConstants[_0x5048f1(0x10d)],_0x42dc5f,_0x4648cb),_0x5e7fdf=this[_0x5048f1(0x122)](_0x42abe8,_0x1f1e2e,_0x4648cb);await this['checkAndSetupPercy'](_0x49262e,_0x4cd55c);if(_0x28a518[_0x5048f1(0x146)](testhubUtils[_0x5048f1(0x118)](_0x49262e[_0x5048f1(0x104)]),null)){const _0x4fbdf4=_0x5e7fdf[_0x28a518['BKSWo']];_0x4fbdf4&&_0x4fbdf4[_0x5048f1(0x154)]&&_0x4fbdf4[_0x5048f1(0xe1)]&&(_0x49262e[_0x5048f1(0x104)][_0x5048f1(0xec)]=!![],process[_0x5048f1(0xfb)][_0x5048f1(0x14a)]=_0x28a518[_0x5048f1(0xeb)]);}return _0x5e7fdf;}catch(_0x792e66){if(_0x28a518[_0x5048f1(0x146)](_0x792e66[_0x5048f1(0x142)],![])){testhubUtils[_0x5048f1(0x102)](_0x792e66);return;}}})();}static async[a124_0x391b1a(0x143)](){const _0x639da2=a124_0x391b1a,_0x5c62b9={'Nfhqv':function(_0x23d644,_0x12a425,_0x512c37){return _0x23d644(_0x12a425,_0x512c37);},'pSfyN':function(_0x444c63,_0x1f93c5){return _0x444c63(_0x1f93c5);},'sJuom':function(_0x3c3e81){return _0x3c3e81();},'WOzAl':_0x639da2(0xe3)};if(processedTraceZips)return;const _0x22fce2=TestDetails[_0x639da2(0x152)]();_0x22fce2['forEach'](({testUId:_0x3f055d,filePath:_0x21cdcb})=>{const _0x220dfd=_0x639da2;var _0x2e40cd=_0x5c62b9[_0x220dfd(0x13d)](uploadTraceZip,_0x21cdcb,_0x3f055d);_0x5c62b9[_0x220dfd(0xee)](addEvent,_0x2e40cd);});try{await _0x5c62b9[_0x639da2(0x139)](awaitAllEvents),logger[_0x639da2(0xf9)](_0x5c62b9['WOzAl']),processedTraceZips=!![];}catch(_0x1de06e){logger[_0x639da2(0xf5)](_0x639da2(0x136)+util[_0x639da2(0x112)](_0x1de06e));}}static async[a124_0x391b1a(0xb9)](_0x156e25,_0x3c64b8){const _0x19f438=a124_0x391b1a;if(constants['PERCY_SUPPORTED_FRAMEWORKS']['includes'](_0x3c64b8)){await _0x156e25[_0x19f438(0xc5)]();return;}_0x156e25[_0x19f438(0x104)][_0x19f438(0xef)]&&logger[_0x19f438(0xf9)](_0x19f438(0x145)+_0x3c64b8+_0x19f438(0x13e));}static[a124_0x391b1a(0x14f)](_0x319cf9){const _0x3d92bb=a124_0x391b1a,_0x1c860e={'oAZAT':function(_0x16d2c2,_0x181111){return _0x16d2c2(_0x181111);},'OiOLk':_0x3d92bb(0x108)};let _0x332576;if(_0x319cf9[_0x3d92bb(0xc0)]){const _0x589488={};_0x589488[_0x3d92bb(0xce)]=_0x319cf9['accessibilityOptions'],_0x332576=_0x589488;}else{const _0x26fc46={};_0x26fc46[_0x3d92bb(0xce)]={},_0x332576=_0x26fc46;}if((!bsSetupHelper[_0x3d92bb(0x119)]()||_0x1c860e['oAZAT'](isTurboScaleSession,_0x319cf9))&&testhubUtils[_0x3d92bb(0x114)](_0x319cf9)){const _0x2e3040={};_0x2e3040['includeEncodedExtension']=_0x1c860e[_0x3d92bb(0xe7)],Object['assign'](_0x332576[_0x3d92bb(0xce)],_0x2e3040);}return _0x332576;}static[a124_0x391b1a(0xed)](_0xed41d0,_0x22042a){const _0x19b8d3=a124_0x391b1a,_0x3c0e41={'VHbiu':function(_0x339814,_0x1d76ea){return _0x339814(_0x1d76ea);}},_0x1bf5d1={};return _0x1bf5d1[_0x19b8d3(0x13b)]=_0xed41d0,_0x1bf5d1[_0x19b8d3(0x11a)]=_0x22042a,{'auth':_0x1bf5d1,'headers':_0x3c0e41[_0x19b8d3(0xff)](getDefaultHeaders,![])};}static async[a124_0x391b1a(0xc8)](_0x1a3e8d,_0x1977b6){const _0x52cddc=a124_0x391b1a,_0x235793={'gJFGQ':_0x52cddc(0x120),'gHVwZ':function(_0x2bdd09,_0x539846){return _0x2bdd09(_0x539846);}};logger[_0x52cddc(0xf9)](_0x235793[_0x52cddc(0xdd)]);const _0x456060={'project_name':_0x1a3e8d[_0x52cddc(0x137)]||'','name':_0x1a3e8d[_0x52cddc(0x11c)]||path[_0x52cddc(0xf6)](path[_0x52cddc(0xc6)](process[_0x52cddc(0xdc)]())),'build_identifier':_0x1a3e8d[_0x52cddc(0x127)],'description':_0x1a3e8d[_0x52cddc(0xdb)]||'','started_at':new Date()[_0x52cddc(0xcb)](),'tags':_0x235793[_0x52cddc(0xd9)](getCustomTags,_0x1a3e8d),'host_info':bsSetupHelper[_0x52cddc(0x10b)](),'ci_info':bsSetupHelper['getCiInfo'](),'build_run_identifier':process[_0x52cddc(0xfb)][_0x52cddc(0x141)],'failed_tests_rerun':process[_0x52cddc(0xfb)][_0x52cddc(0x150)]||![],'linked_build_uuid':process['env'][_0x52cddc(0x109)]||'','version_control':await bsSetupHelper['getGitMetaData'](),'accessibility':this['getAccessibilityOptions'](_0x1a3e8d),'framework_details':testhubUtils['getFrameworkDetails'](_0x1a3e8d,_0x1977b6),'product_map':testhubUtils[_0x52cddc(0x14e)](_0x1a3e8d),'browserstackAutomation':bsSetupHelper[_0x52cddc(0x119)](),'grouping_identifier':process['env'][_0x52cddc(0x140)],'test_orchestration':testhubUtils[_0x52cddc(0x10f)](_0x1a3e8d)};if(bsSetupHelper['getCentralUser']()['central_scanner']||bsSetupHelper[_0x52cddc(0xfa)]()['lcnc']){const _0x543acb={};_0x543acb[_0x52cddc(0x14c)]=process[_0x52cddc(0xfb)][_0x52cddc(0xbc)],_0x543acb[_0x52cddc(0x100)]=process[_0x52cddc(0xfb)][_0x52cddc(0x121)],_0x456060[_0x52cddc(0x128)]=_0x543acb;}return _0x456060;}static['extractDataFromResponse'](_0x2baa21,_0x4eaffc,_0x566f69){const _0x22225d=a124_0x391b1a,_0x51bf6f={'FKpNg':function(_0x430988){return _0x430988();},'DwRqe':function(_0xae6881,_0x12ae9f){return _0xae6881&&_0x12ae9f;},'lzYyv':'true','iCKhR':_0x22225d(0x103),'jouKS':function(_0x26c216,_0x569ace){return _0x26c216&&_0x569ace;}},_0xd60a48={};if(_0x51bf6f[_0x22225d(0xe9)](isTestObservabilitySession)){const [_0x2a76c1,_0x23e6d1,_0x4954ca]=testhubUtils[_0x22225d(0xf7)](_0x4eaffc[_0x22225d(0x11e)],_0x566f69[_0x22225d(0x10c)]);if(_0x51bf6f[_0x22225d(0xfe)](_0x2a76c1,_0x23e6d1)){const _0x3e781a={};_0x3e781a[_0x22225d(0xcc)]=_0x2a76c1,_0x3e781a['buildHashedId']=_0x23e6d1,_0x3e781a[_0x22225d(0x13f)]=_0x4954ca,_0xd60a48[testHubConstants[_0x22225d(0xd0)]]=_0x3e781a,process[_0x22225d(0xfb)][_0x22225d(0x124)]=_0x51bf6f[_0x22225d(0x147)];}else _0xd60a48[testHubConstants['OBSERVABILITY']]={},process[_0x22225d(0xfb)][_0x22225d(0x124)]=_0x51bf6f[_0x22225d(0xf8)];}else process[_0x22225d(0xfb)][_0x22225d(0x124)]=_0x51bf6f[_0x22225d(0xf8)];const [_0x192695,_0x306e17]=testhubUtils[_0x22225d(0xde)](_0x4eaffc[_0x22225d(0x11e)]);if(_0x51bf6f[_0x22225d(0xc4)](_0x192695,_0x306e17)){const _0x382112={};_0x382112[_0x22225d(0x154)]=_0x192695,_0x382112['buildHashedId']=_0x306e17,_0xd60a48[testHubConstants['ACCESSIBILITY']]=_0x382112,process[_0x22225d(0xfb)]['BROWSERSTACK_ACCESSIBILITY']=_0x51bf6f[_0x22225d(0x147)];}else _0xd60a48[testHubConstants[_0x22225d(0xd8)]]={},process[_0x22225d(0xfb)][_0x22225d(0xfc)]=_0x51bf6f[_0x22225d(0xf8)];return testhubUtils['setTestHubCommonMetaInfo'](_0x4eaffc[_0x22225d(0x11e)]),logger[_0x22225d(0x149)](_0x22225d(0xe2)+process['env'][_0x22225d(0x125)]),_0xd60a48;}static async[a124_0x391b1a(0x144)](_0x172f5b){const _0x299a3d=a124_0x391b1a,_0x372881={'rkfQb':function(_0x54f2ff,_0x5107d7){return _0x54f2ff===_0x5107d7;},'CzqUI':_0x299a3d(0x103),'VtUUM':_0x299a3d(0xca),'UVAOQ':function(_0x4569e3,_0x2ad13f){return _0x4569e3===_0x2ad13f;},'lsLIo':_0x299a3d(0xf1),'cUgRs':'error','qChWa':'Token/buildID\x20is\x20undefined,\x20build\x20creation\x20might\x20have\x20failed','JQvhq':'finished_metadata','xqjTv':_0x299a3d(0x13a),'hbgDn':function(_0x345bb7){return _0x345bb7();},'xGExc':function(_0x4d95df,_0x453f69,_0x4849e7,_0x5a9f79,_0x3c4824,_0x28d033){return _0x4d95df(_0x453f69,_0x4849e7,_0x5a9f79,_0x3c4824,_0x28d033);},'YRcSL':_0x299a3d(0x155),'CuzBm':'stopBuildUpstream\x20event\x20successful!','eFopp':'success'};!BrowserstackCLI[_0x299a3d(0xda)]()['isRunning']()&&await this[_0x299a3d(0x143)](),await PerformanceTester[_0x299a3d(0x10e)](PerformanceEvents[_0x299a3d(0xd7)],async()=>{const _0x471e86=_0x299a3d;if(_0x372881[_0x471e86(0xcd)](process[_0x471e86(0xfb)][_0x471e86(0x11d)],_0x372881[_0x471e86(0xf4)])||TestHubHandler[_0x471e86(0x115)]||bsSetupHelper['isUndefined'](process['env'][testHubConstants[_0x471e86(0xe8)]['BROWSERSTACK_TESTHUB_JWT']]))return;TestHubHandler[_0x471e86(0x115)]=!![],await RequestQueueHandler[_0x471e86(0xda)]()['uploadPending'](),await SessionHandler['waitForBuildStatus']();if(_0x372881[_0x471e86(0xcd)](process['env'][testHubConstants[_0x471e86(0xe8)][_0x471e86(0xf0)]],_0x372881[_0x471e86(0x14b)])||_0x372881[_0x471e86(0x111)](process['env'][testHubConstants['ENV_VAR']['BROWSERSTACK_TESTHUB_UUID']],_0x372881[_0x471e86(0x14b)])){logger[_0x471e86(0xf9)](_0x372881[_0x471e86(0x101)]);const _0x490317={};return _0x490317[_0x471e86(0xe6)]=_0x372881[_0x471e86(0x117)],_0x490317[_0x471e86(0x129)]=_0x372881[_0x471e86(0xbf)],_0x490317;}const _0x57c328={'finished_at':new Date()[_0x471e86(0xcb)](),'finished_metadata':[]};!!_0x172f5b&&_0x57c328[_0x372881['JQvhq']][_0x471e86(0x134)]({'reason':_0x372881[_0x471e86(0x12f)],'signal':_0x172f5b,'failure_data':''});const _0xd2402b={'headers':_0x372881[_0x471e86(0xc1)](getDefaultHeaders)};try{const _0x38b81a=await _0x372881[_0x471e86(0xc9)](nodeRequest,_0x372881['YRcSL'],_0x471e86(0x107)+process[_0x471e86(0xfb)][testHubConstants['ENV_VAR'][_0x471e86(0x125)]]+_0x471e86(0x14d),_0x57c328,_0xd2402b,![]);if(_0x38b81a[_0x471e86(0x11e)]&&_0x38b81a['data'][_0x471e86(0xf5)]){const _0x5e06bc={};_0x5e06bc['message']=_0x38b81a[_0x471e86(0x11e)][_0x471e86(0xf5)];throw _0x5e06bc;}else{logger[_0x471e86(0xf9)](_0x372881['CuzBm']);const _0x2e5124={};return _0x2e5124['status']=_0x372881[_0x471e86(0x12a)],_0x2e5124[_0x471e86(0x129)]='',_0x2e5124;}}catch(_0x4bec3b){_0x4bec3b[_0x471e86(0xc3)]?logger[_0x471e86(0xf9)](_0x471e86(0x12b)+_0x4bec3b['response'][_0x471e86(0xe6)]+'\x20'+_0x4bec3b[_0x471e86(0xc3)]['statusText']+'\x20'+JSON[_0x471e86(0xf3)](_0x4bec3b['response'][_0x471e86(0x11e)])):logger[_0x471e86(0xf9)](_0x471e86(0x12b)+(_0x4bec3b[_0x471e86(0x129)]||_0x4bec3b));const _0x4263d3={};return _0x4263d3[_0x471e86(0xe6)]=_0x372881[_0x471e86(0x117)],_0x4263d3[_0x471e86(0x129)]=_0x4bec3b[_0x471e86(0x129)]||_0x4bec3b[_0x471e86(0xc3)]?_0x4bec3b['response']['status']+':'+_0x4bec3b[_0x471e86(0xc3)]['statusText']:_0x4bec3b,_0x4263d3;}})();}}function a124_0x4dbb(_0xbc402,_0x3befb3){const _0x1a2f05=a124_0x1a2f();return a124_0x4dbb=function(_0x4dbbbc,_0x4a4205){_0x4dbbbc=_0x4dbbbc-0xb9;let _0x27dd9c=_0x1a2f05[_0x4dbbbc];return _0x27dd9c;},a124_0x4dbb(_0xbc402,_0x3befb3);}module[a124_0x391b1a(0x151)]=TestHubHandler;