const a28_0x1079a8=a28_0x2a2f;(function(_0x1704f3,_0x150e5a){const _0x3461b9=a28_0x2a2f,_0x214e65=_0x1704f3();while(!![]){try{const _0x3c33af=-parseInt(_0x3461b9(0x137))/0x1+-parseInt(_0x3461b9(0x11f))/0x2+parseInt(_0x3461b9(0x125))/0x3+-parseInt(_0x3461b9(0x117))/0x4+parseInt(_0x3461b9(0x129))/0x5+parseInt(_0x3461b9(0x10a))/0x6*(-parseInt(_0x3461b9(0x10e))/0x7)+parseInt(_0x3461b9(0x12c))/0x8*(parseInt(_0x3461b9(0x11a))/0x9);if(_0x3c33af===_0x150e5a)break;else _0x214e65['push'](_0x214e65['shift']());}catch(_0x1dfd98){_0x214e65['push'](_0x214e65['shift']());}}}(a28_0x598b,0x94093));function a28_0x2a2f(_0x9fdfd4,_0x34dede){const _0x598b64=a28_0x598b();return a28_0x2a2f=function(_0x2a2fb4,_0x1213df){_0x2a2fb4=_0x2a2fb4-0x108;let _0x37c428=_0x598b64[_0x2a2fb4];return _0x37c428;},a28_0x2a2f(_0x9fdfd4,_0x34dede);}const fs=require('fs'),path=require(a28_0x1079a8(0x12d)),Promise=require(a28_0x1079a8(0x140)),yaml=require(a28_0x1079a8(0x120)),{CLOUDFORMATION_SCHEMA}=require(a28_0x1079a8(0x131)),AWS=require(a28_0x1079a8(0x110))[a28_0x1079a8(0x118)],AWSUtils=require('./AWSUtils'),{CLUSTER_HUB_HA_STACK_NAME,COMMON_HST_TAGS}=require('../config/constants'),{logger}=require(a28_0x1079a8(0x143));Promise['promisifyAll'](fs);const addTags=async(_0x48d55c,_0x32f911)=>{const _0x571457=a28_0x1079a8;for(const _0x59c75a in _0x48d55c[_0x571457(0x123)]){_0x48d55c[_0x571457(0x123)][_0x59c75a][_0x571457(0x13c)]&&_0x48d55c[_0x571457(0x123)][_0x59c75a][_0x571457(0x13c)]['Tags']&&_0x48d55c['Resources'][_0x59c75a][_0x571457(0x13c)][_0x571457(0x12f)][_0x571457(0x139)](..._0x32f911);}};exports[a28_0x1079a8(0x145)]=async(_0x8f597d,_0x48263d=null)=>{const _0x21212b=a28_0x1079a8,_0x2a92f2={'VmjVb':_0x21212b(0x10c),'RgwTR':'browserstack:creationDate','zGQSC':_0x21212b(0x136),'MqAsR':_0x21212b(0x132),'uKrsH':_0x21212b(0x11e),'qRpVt':'utf-8','vmACC':function(_0x1089f5,_0x491862,_0x54766c){return _0x1089f5(_0x491862,_0x54766c);},'JZtvI':_0x21212b(0x12e),'VrVKE':_0x21212b(0x114),'biKuc':_0x21212b(0x13b),'rDzdo':_0x21212b(0x121),'wdeep':_0x21212b(0x112),'XAZPl':_0x21212b(0x11d),'Dnhei':_0x21212b(0x138),'GYlKw':_0x21212b(0x130)},_0x2c39d6=COMMON_HST_TAGS,_0xbc035e={};_0xbc035e[_0x21212b(0x12b)]=_0x2a92f2['VmjVb'],_0xbc035e[_0x21212b(0x141)]=_0x8f597d,_0x2c39d6[_0x21212b(0x139)](_0xbc035e),_0x2c39d6['push']({'Key':_0x2a92f2[_0x21212b(0x111)],'Value':new Date()['valueOf']()['toString']()});const _0x43c377={};_0x43c377['apiVersion']=_0x2a92f2[_0x21212b(0x133)];const _0x30a5c5=new AWS[(_0x21212b(0x119))](_0x43c377),_0x253df5=await fs[_0x21212b(0x127)](path[_0x21212b(0x142)](__dirname,'..',_0x2a92f2[_0x21212b(0x10d)],_0x2a92f2[_0x21212b(0x13d)]),_0x2a92f2['qRpVt']),_0x138c82={};_0x138c82[_0x21212b(0x12a)]=CLOUDFORMATION_SCHEMA;const _0x15910c=yaml[_0x21212b(0x124)](_0x253df5,_0x138c82);await _0x2a92f2[_0x21212b(0x13a)](addTags,_0x15910c,_0x2c39d6);const _0x125878=JSON['stringify'](_0x15910c);let _0x168839=await AWSUtils[_0x21212b(0x128)](_0x8f597d);_0x168839=_0x168839[_0x21212b(0x13e)](_0x2a92f2['JZtvI'])[0x1];const _0x37fc4a={};_0x37fc4a[_0x21212b(0x122)]=CLUSTER_HUB_HA_STACK_NAME+'-'+_0x8f597d+_0x21212b(0x108),_0x37fc4a[_0x21212b(0x109)]=_0x2a92f2[_0x21212b(0x115)],_0x37fc4a[_0x21212b(0x126)]=_0x125878,_0x37fc4a[_0x21212b(0x11c)]=[{'ParameterKey':_0x2a92f2['biKuc'],'ParameterValue':_0x48263d},{'ParameterKey':_0x2a92f2['rDzdo'],'ParameterValue':CLUSTER_HUB_HA_STACK_NAME+'-'+_0x8f597d},{'ParameterKey':_0x2a92f2[_0x21212b(0x144)],'ParameterValue':_0x168839}],_0x37fc4a[_0x21212b(0x11b)]=[_0x2a92f2[_0x21212b(0x10b)]],_0x37fc4a[_0x21212b(0x12f)]=_0x2c39d6;const _0x4853d0=_0x37fc4a,_0x7bb151=await _0x30a5c5[_0x21212b(0x10f)](_0x4853d0)[_0x21212b(0x116)]();logger[_0x21212b(0x135)](_0x2a92f2['Dnhei']);const _0x56a894={};return _0x56a894[_0x21212b(0x122)]=_0x7bb151[_0x21212b(0x134)],_0x30a5c5[_0x21212b(0x13f)](_0x2a92f2[_0x21212b(0x113)],_0x56a894)[_0x21212b(0x116)]();};function a28_0x598b(){const _0x209440=['3503997pxzAxV','Capabilities','Parameters','CAPABILITY_NAMED_IAM','hub-ha.yaml','1273330QkngiE','js-yaml','BaseResourceName','StackName','Resources','load','2439735NghlDJ','TemplateBody','readFileAsync','getOidcUrl','776915AHopzj','schema','Key','40Wszvnt','path','://','Tags','stackCreateComplete','js-yaml-cloudformation-schema','CFTemplates','zGQSC','StackId','info','2010-05-15','1101032uWLyMx','Waiting\x20for\x20CloudFormation\x20stack\x20to\x20complete','push','vmACC','VpcId','Properties','uKrsH','split','waitFor','bluebird','Value','join','../config/logger','wdeep','createHubHaStack','-cf','OnFailure','390612McHMzY','XAZPl','browserstack:cluster','MqAsR','35RmHuqy','createStack','./AWSUtils','RgwTR','ClusterOIDCURL','GYlKw','DELETE','VrVKE','promise','982924CvaGJg','awsObj','CloudFormation'];a28_0x598b=function(){return _0x209440;};return a28_0x598b();}